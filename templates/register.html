<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
          crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/static/css/style.css">
        <title>{{ title }}</title>
    </head>
    <body>
      {% extends "base.html" %}

        {% block content %}
        <h1>Регистрайия нового пользователя</h1>
        {% if message %}
            <div class="alert alert-danger" role="alert">
              {{ message }}
            </div>
        {% endif %}
        <form action="" method="post" enctype="multipart/form-data">
            {{ form.hidden_tag() }}
            <p>
              <label class="images">
                <img class="avatar1" id="preview">
                <img class="avatar" src="/static/img/users/default.png">
                &emsp;{{ form.photo(class='avatar form-control', id='fileInput', type='file', hidden=true)}}
                  {{ form.username(class="inp", size=200, maxlength=50, type="string", placeholder=form.username.label.text) }}<br>
                  {% for error in form.username.errors %}
                      <div class="alert alert-danger" role="alert">
                          {{ error }}
                      </div>
                  {% endfor %}
            </label>&emsp;
            </p>
            {% for i in form if i.name != 'photo' and i.name != 'username' and i.name != 'csrf_token' and i.name != 'submit' %}
            <p>
                {{ i(class="form-control", placeholder=i.label.text) }}<br>
                {% for error in i.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ error }}
                </div>
                {% endfor %}
            </p>
            {% endfor %}
            <p>{{ form.submit(type="submit", class="btn btn-primary") }}</p>
        </form>

        <script>
            const fileInput = document.getElementById('fileInput');
            const preview = document.getElementById('preview');

            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.src = e.target.result;
                        preview.style.display = 'block';
                    }
                    reader.readAsDataURL(file);
                }
            });
        </script>
        {% endblock %}
    </body>
</html>